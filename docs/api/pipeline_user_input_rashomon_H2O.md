[back](index.md)

# BuildRashomonH2O

<div style="background-color: #c2deb1; padding: 10px; border-radius: 4px;">
class rashomon_analysis.pipelines.pipelines_user_input.<strong>BuildRashomonH2O</strong>(models_directory, test_data, target_column, df_name, base_metric, delta, feature_imp_needed, converter_results_directory)
</div>
</br>
This is a subclass of a <code>Builder</code> abstract class, which provides pipeline for creating and exploring the Rashomon Set from user-provided models from H2O framework.
</br>
</br>
Example usage of this pipeline can be found at <code>demo_notebooks/H2O_pipeline.ipynb</code>.
</br>
</br>
</br>


<div style="background-color: lightgray; padding: 3px; border-radius: 0px;">
<strong>Parameters</strong>
</div>
</br>
    <strong>models_directory</strong> : Path </br>
     &emsp;  Path to a folder where all models saved from H2O output are stored.
    </br>
    <br>
    <strong>test_data</strong> : h2o.H2OFrame </br>
    &emsp; Test dataset for evaluation, must be converted to <code>h20.H2OFrame</code> object. <br>
    &emsp; Note 1: <em> It is crucial to stratify your data while performing the train test split, so that there are no classes in test data that were not present in the train set. </em> <br>
    &emsp; Note 2 (for binary classification task): <em> It is crucial to convert binary target column labels into 0 for negative class and 1 for positive class. Otherwise, some evaluation metrics may not be calculated correctly. </em>
    </br>
    <br>
    <strong>target_column</strong> : str </br>
    &emsp; Name of the target column for the classification task. Used to determine whether the task type is binary or multiclass.
    </br>
    <br>
    <strong>df_name</strong> : str </br>
    &emsp; Name of the dataset used for saving the data generated by <code>H2O_Converter</code> output.
    </br>
    <br>
    <strong>base_metric</strong> : str </br>
    &emsp; Evaluation metric to be used as a primary value for sorting model performances and constructing the Rashomon Set.
    </br>
    <br>
    <strong>delta</strong> : float </br>
     &emsp; Delta parameter for probabilistic ambiguity and discrepancy (used only for binary task type). <br>
     &emsp; If not specified the default value of 0.1 will be used.
    </br>
    <br>
    <strong>feature_imp_needed</strong> : bool </br>
     &emsp; Boolean value specifying whether feature importance computation is required. <br>
     &emsp; Defaults to True; set to False to skip feature importance computation for faster execution.
     </br>
     <br>
    <strong>converter_results_directory</strong> : Path </br>
     &emsp; Path to the directory where the converter outputs will be saved. <br>
     &emsp; If <code>None</code>, a default directory <code>converter_results/df_name_timestamp</code> will be automatically created in the same directory as <code>models_directory</code>, where timestamp corresponds to the creation time of the converted outputs. 
     </br>
</br>

<div style="background-color: lightgray; padding: 3px; border-radius: 0px;">
    <strong>BuildRashomonH2O Pipeline – Key Steps</strong>
</div>
<br>
<ol>
    <li><strong>Initialization (<code>__init__</code>)</strong> – Convert H2O models to format for Rashomon Set analysis.</li>
    <li><strong>Preview Rashomon (<code>preview_rashomon()</code>)</strong> – Visualize leaderboard and Rashomon Set sizes to guide epsilon selection.</li>
    <li><strong>Set Epsilon (<code>set_epsilon()</code>)</strong> – Set epsilon parameter value to be used when creating Rashomon Set.</li>
    <li><strong>Build Pipeline (<code>build()</code>)</strong> – Create RashomonSet, Visualizer objects and launch the Streamlit dashboard.</li>
    <li><strong>Interactive Analysis</strong> – Explore plots via Visualizer object or the dashboard.</li>
    <li><strong>Close Dashboard (<code>dashboard_close()</code>)</strong> – Stop Streamlit processes.</li>
</ol>
<br>

<div style="background-color: lightgray; padding: 3px; border-radius: 0px;">
<strong>Pipeline Initialization</strong>
</div>
</br>
&emsp; During initialization, the pipeline converts the user's input models into the internal format specified by <code>H2O_Converter</code> class object.  <br>
&emsp; All processed results are stored in the specified directory or in a default directory created based on the dataset name and timestamp (see converter_results_directory parameter).  <br>
<br>


<div style="background-color: lightgray; padding: 3px; border-radius: 0px;">
<strong>Methods</strong>
</div>
</br>

<div style="color: #60824f; font-size: 18px;">
    <strong>preview_rashomon()</strong>
</div>
&emsp; Method illustrating the leaderboard and the plot with all possible epsilon values and the Rashomon Set sizes for different epsilon values. <br>
&emsp; Should be called to guide the selection of an appropriate epsilon threshold.
</br>
</br>

<div style="color: #60824f; font-size: 18px;">
    <strong>visualize_rashomon_set_volume()</strong>
</div>
&emsp; Method for visualising Rashomon set size depending on different epsilon values.
</br>
</br>

<div style="color: #60824f; font-size: 18px;">
    <strong>set_epsilon(<code>epsilon</code>)</strong>
</div>
&emsp; Sets the epsilon parameter value to be used when constructing the Rashomon Set object.<br>
&emsp; <strong> Epsilon value must be set before calling build() method. </strong>
</br>
</br>
&emsp; <strong>Parameters :</strong> </br>
&emsp; <code>epsilon</code> : float <br>
<br>

<div style="color: #60824f; font-size: 18px;">
    <strong>build()</strong>
</div>
&emsp;Builds the Rashomon Set pipeline from H2O models. <br>
&emsp; Creates Rashomon Set object and Visualizer object from user's input and launches a Streamlit dashboard in a subprocess for interactive visualization.
</br>
</br>
&emsp; This method performs the following steps:
<ul>
<li>Validates that the epsilon threshold has been set using <code>set_epsilon()</code> method.</li><br>
<li>Creates the <code>RashomonSet</code> object based on the leaderboard, predictions, probability predictions, feature importances, base metric, and epsilon threshold. <br>
All inputs required to build the Rashomon Set object are extracted from the user's data, which is processed and converted during the pipeline initialization.</li><br>
<li>Initializes the <code>Visualizer</code> object for interactive analysis of the Rashomon Set. <br>
Individual plots can later be generated directly from the <code>Visualizer</code> object.</li><br>
<li>Generates plots for analysis depending on the task type (binary or multiclass), and stores them temporarily with their descriptions for the Streamlit dashboard.</li><br>
<li>Closes any previous Streamlit processes to avoid conflicts.</li><br>
<li>Launches the Streamlit dashboard in a subprocess on the local machine (localhost), allowing interactive exploration of the Rashomon Set properties without blocking the main workflow.</li>

</ul>
</br>
&emsp; <strong>Returns :</strong> </br>
&emsp; <code>rashomon_set</code> : RashomonSet
</br>
&emsp; <code>visualizer</code> : Visualizer
</br>
</br>

<div style="color: #60824f; font-size: 18px;">
    <strong>dashboard_close()</strong>
</div>
&emsp; Method for stopping all Streamlit processes and closing the dashboard.<br>
&emsp; Note: <em>Always call this method after finishing the analysis to ensure the dashboard is properly closed.</em>

<br>



